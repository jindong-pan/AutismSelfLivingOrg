<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ç™»å½•è´¦å· - Peaceful Independence</title>
    <meta name="description" content="ç™»å½•åˆ°æ‚¨çš„Peaceful Independenceè´¦å·ï¼Œè®¿é—®ä¸ªæ€§åŒ–æ”¯æŒå’ŒæœåŠ¡ã€‚">
    <link rel="stylesheet" href="static/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="icon" href="static/logo-icon.svg">
</head>
<body>
    <!-- Navigation -->
    <nav class="navbar">
        <div class="container">
            <div class="logo">
                <img src="static/logo-icon.svg" alt="Peaceful Independence Logo" class="logo-icon-svg">
                <span>Peaceful Independence</span>
            </div>
            <div class="nav-right">
                <div class="language-links">
                    <a href="login-zh.html" class="lang-link">ä¸­æ–‡</a>
                    <span class="lang-separator">|</span>
                    <a href="login-es.html" class="lang-link">EspaÃ±ol</a>
                </div>
                <ul class="nav-links">
                    <li><a href="index.html">é¦–é¡µ</a></li>
                    <li><a href="register.html">æ³¨å†Œ</a></li>
                </ul>
                <div class="hamburger">
                    <span></span>
                    <span></span>
                    <span></span>
                </div>
            </div>
        </div>
    </nav>

    <!-- Login Section -->
    <section class="auth-section">
        <div class="container">
            <div class="auth-container">
                <div class="auth-header">
                    <h1>ç™»å½•è´¦å·</h1>
                    <p>æ¬¢è¿å›æ¥ï¼è¯·ç™»å½•æ‚¨çš„è´¦å·</p>
                </div>

                <form id="loginForm" class="auth-form">
                    <div class="form-group">
                        <label for="email">é‚®ç®±åœ°å€ *</label>
                        <input type="email" id="email" name="email" required>
                    </div>

                    <div class="form-group">
                        <label for="password">å¯†ç  *</label>
                        <input type="password" id="password" name="password" required>
                    </div>

                    <div class="form-group checkbox-group">
                        <input type="checkbox" id="remember" name="remember">
                        <label for="remember" class="checkbox-label">
                            è®°ä½æˆ‘
                        </label>
                    </div>

                    <button type="submit" class="btn btn-primary btn-full">ç™»å½•</button>
                </form>

                <div class="auth-footer">
                    <p>å¿˜è®°å¯†ç ï¼Ÿ<a href="#" id="forgotPassword">é‡ç½®å¯†ç </a></p>
                    <p>è¿˜æ²¡æœ‰è´¦å·ï¼Ÿ<a href="register.html">ç«‹å³æ³¨å†Œ</a></p>
                </div>

                <div id="message" class="message" style="display: none;"></div>
            </div>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="container">
            <div class="footer-content">
                <div class="footer-section">
                    <div class="logo">
                        <img src="static/logo-icon.svg" alt="Peaceful Independence Logo" class="logo-icon-svg">
                        <span>Peaceful Independence</span>
                    </div>
                    <p>Relieving Burdens, Enabling Independence</p>
                </div>
                <div class="footer-section">
                    <h4>å¿«é€Ÿé“¾æ¥</h4>
                    <ul>
                        <li><a href="index.html">é¦–é¡µ</a></li>
                        <li><a href="about.html">å…³äºæˆ‘ä»¬</a></li>
                        <li><a href="services.html">æˆ‘ä»¬çš„æœåŠ¡</a></li>
                        <li><a href="contact.html">è”ç³»æˆ‘ä»¬</a></li>
                    </ul>
                </div>
                <div class="footer-section">
                    <h4>è”ç³»ä¿¡æ¯</h4>
                    <p>ğŸ“§ info@independentspectrum.org</p>
                    <p>ğŸ“± +1 (555) 123-4567</p>
                    <p>ğŸ“ åœ¨çº¿æ”¯æŒæœåŠ¡</p>
                </div>
            </div>
            <div class="footer-bottom">
                <p>&copy; 2025 Peaceful Independence. All rights reserved. | Website powered by AI</p>
            </div>
        </div>
    </footer>

    <!-- Firebase SDK -->
    <script type="module">
        // å¯¼å…¥Firebaseæ¨¡å—
        import { initializeApp } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-app.js';
        import { getAuth, signInWithEmailAndPassword, sendPasswordResetEmail } from 'https://www.gstatic.com/firebasejs/9.22.0/firebase-auth.js';

        // Firebaseé…ç½®
        const firebaseConfig = {
            apiKey: "AIzaSyDz3DtqF6RuJoKiRfcznepfO5zyXwcKMLc",
            authDomain: "peaceful-independence.firebaseapp.com",
            projectId: "peaceful-independence",
            storageBucket: "peaceful-independence.firebasestorage.app",
            messagingSenderId: "989115528458",
            appId: "1:989115528458:web:36615bf180d2110d1576f3",
            measurementId: "G-30HKN7XFT5"
        };

        // åˆå§‹åŒ–Firebase
        const app = initializeApp(firebaseConfig);
        const auth = getAuth(app);

        // ç™»å½•è¡¨å•å¤„ç†
        document.getElementById('loginForm').addEventListener('submit', async (e) => {
            e.preventDefault();

            const email = document.getElementById('email').value;
            const password = document.getElementById('password').value;

            try {
                // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
                const submitBtn = document.querySelector('button[type="submit"]');
                submitBtn.textContent = 'ç™»å½•ä¸­...';
                submitBtn.disabled = true;

                // ç™»å½•ç”¨æˆ·
                const userCredential = await signInWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;

                showMessage('ç™»å½•æˆåŠŸï¼æ­£åœ¨è·³è½¬...', 'success');

                // å»¶è¿Ÿè·³è½¬åˆ°ä»ªè¡¨æ¿
                setTimeout(() => {
                    window.location.href = 'dashboard.html';
                }, 1500);

            } catch (error) {
                console.error('ç™»å½•é”™è¯¯:', error);
                let errorMessage = 'ç™»å½•å¤±è´¥ï¼Œè¯·æ£€æŸ¥é‚®ç®±å’Œå¯†ç ';

                switch (error.code) {
                    case 'auth/user-not-found':
                        errorMessage = 'ç”¨æˆ·ä¸å­˜åœ¨';
                        break;
                    case 'auth/wrong-password':
                        errorMessage = 'å¯†ç é”™è¯¯';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'é‚®ç®±æ ¼å¼ä¸æ­£ç¡®';
                        break;
                    case 'auth/user-disabled':
                        errorMessage = 'è´¦å·å·²è¢«ç¦ç”¨';
                        break;
                    case 'auth/too-many-requests':
                        errorMessage = 'ç™»å½•å°è¯•æ¬¡æ•°è¿‡å¤šï¼Œè¯·ç¨åå†è¯•';
                        break;
                    case 'auth/network-request-failed':
                        errorMessage = 'ç½‘ç»œè¿æ¥å¤±è´¥ï¼Œè¯·æ£€æŸ¥ç½‘ç»œåé‡è¯•';
                        break;
                }

                showMessage(errorMessage, 'error');

                // æ¢å¤æŒ‰é’®çŠ¶æ€
                const submitBtn = document.querySelector('button[type="submit"]');
                submitBtn.textContent = 'ç™»å½•';
                submitBtn.disabled = false;
            }
        });

        // å¿˜è®°å¯†ç å¤„ç†
        document.getElementById('forgotPassword').addEventListener('click', async (e) => {
            e.preventDefault();

            const email = document.getElementById('email').value;

            if (!email) {
                showMessage('è¯·è¾“å…¥é‚®ç®±åœ°å€', 'error');
                return;
            }

            try {
                await sendPasswordResetEmail(auth, email);
                showMessage('å¯†ç é‡ç½®é‚®ä»¶å·²å‘é€ï¼Œè¯·æ£€æŸ¥æ‚¨çš„é‚®ç®±', 'success');
            } catch (error) {
                console.error('é‡ç½®å¯†ç é”™è¯¯:', error);
                let errorMessage = 'å‘é€é‡ç½®é‚®ä»¶å¤±è´¥';

                switch (error.code) {
                    case 'auth/user-not-found':
                        errorMessage = 'æ­¤é‚®ç®±æœªæ³¨å†Œ';
                        break;
                    case 'auth/invalid-email':
                        errorMessage = 'é‚®ç®±æ ¼å¼ä¸æ­£ç¡®';
                        break;
                }

                showMessage(errorMessage, 'error');
            }
        });

        // æ˜¾ç¤ºæ¶ˆæ¯å‡½æ•°
        function showMessage(message, type) {
            const messageDiv = document.getElementById('message');
            messageDiv.textContent = message;
            messageDiv.className = `message ${type}`;
            messageDiv.style.display = 'block';

            // 5ç§’åè‡ªåŠ¨éšè—
            setTimeout(() => {
                messageDiv.style.display = 'none';
            }, 5000);
        }

        // æ£€æŸ¥ç”¨æˆ·æ˜¯å¦å·²ç™»å½•
        auth.onAuthStateChanged((user) => {
            if (user) {
                // ç”¨æˆ·å·²ç™»å½•ï¼Œé‡å®šå‘åˆ°ä»ªè¡¨æ¿
                window.location.href = 'dashboard.html';
            }
        });
    </script>

    <script src="static/script.js"></script>
</body>
</html>
